<!doctype html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>Stoppelrennen Dobberzin 2025 – Live</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root{
            --green:#C6EFCE;--greenText:#006100;--red:#FFC7CE;--redText:#9C0006;
            --gold:#FFD966; --silver:#D9D9D9; --bronze:#F4B183; --final:#E2F0D9;
        }
        *{box-sizing:border-box;margin:0}
        body{font:400 16px/1.45 Roboto,Arial,sans-serif;background:#f7f7f7;color:#111}

        /* ------------- Kopf & Ticker (kein sticky) ------------- */
        header{background:#183028;color:#fff;text-align:center;padding:8px 16px}
        header img{height:48px;margin-right:8px;vertical-align:middle}
        #sponsors{overflow:hidden;background:#fff;border-block:2px solid #eee}
        #sponsors .track{display:flex;gap:64px;animation:scroll 25s linear infinite;padding:4px 0}
        #sponsors img{height:36px;max-width:140px;vertical-align:middle}
        @keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}

        /* ------------- Tabs ---------------------------- */
        nav{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin:16px auto}
        nav button{padding:8px 16px;border:1px solid #ccc;border-radius:4px;background:#fff;font-weight:700;cursor:pointer}
        nav button.active{background:#183028;color:#fff;border-color:#183028}

        /* ------------- List–Layout -------------------- */
        .section{display:none;max-width:1000px;margin:0 auto;padding:0 8px 48px}
        .section.active{display:block}
        .row{display:flex;border-bottom:1px solid #ddd;padding:6px 0}
        .col{padding:0 6px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}
        .col.platz{width:78px} .col.rennen{width:78px}
        .col.start{width:120px}
        .col.fahrer{flex:1 1 auto}
        .col.punkte,.col.qual{width:90px;text-align:right}
        .badge{display:inline-block;padding:2px 6px;border-radius:4px;font-weight:700;font-size:.8em}
        .badge.q{background:var(--green);color:var(--greenText)}
        .badge.out{background:var(--red);color:var(--redText)}
        .badge.gold{background:var(--gold)} .badge.silver{background:var(--silver)}
        .badge.bronze{background:var(--bronze)} .badge.final{background:var(--final)}
        .updated{text-align:center;font-size:12px;color:#666;margin-top:6px}

        /* ----- Mobile (Labels oben) ----- */
        @media (max-width:600px){
            .row{display:block;border-bottom:1px solid #ccc;margin-bottom:8px;padding:8px 4px}
            .col{display:block;padding:2px 0}
            .col::before{content:attr(data-label) ": ";font-weight:700}
            .col.fahrer{white-space:normal}
        }
    </style>
</head>
<body>

<header><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSh2xaOaoQRipR8bA5GghETop505AnzMnHSQQ&s" alt="">
    Stoppelrennen Dobberzin 2025 – Live-Ergebnisse</header>
<div id="sponsors"><div class="track" id="sponsorTrack"></div></div>

<nav id="tabs">
    <button data-tab="leader" class="active">Leaderboard</button>
    <button data-tab="vf">Viertelfinale</button>
    <button data-tab="hf">Halbfinale</button>
    <button data-tab="fin">Finale</button>
</nav>

<!-- Container für Listen -->
<div id="leader" class="section active"><div id="list-leader"></div><div class="updated" id="upd-leader"></div></div>
<div id="vf"     class="section"><div id="list-vf"></div><div class="updated" id="upd-vf"></div></div>
<div id="hf"     class="section"><div id="list-hf"></div><div class="updated" id="upd-hf"></div></div>
<div id="fin"    class="section"><div id="list-fin"></div><div class="updated" id="upd-fin"></div></div>

<script>
  /* ---------------- Config ---------------- */
  const CFG={
    api:'https://script.google.com/macros/s/AKfycbxwYM9iv0b0LfLZrwu1Pr579pQ5_cos7iGFEUkJE556HYNw2peBBsGvmEctSqVz-xhE1Q/exec',
    refresh:30000,
    sponsors:[
      {n:'MGQ',l:'https://s3.ca-central-1.amazonaws.com/logojoy/logos/121849650/noBgColor.png',href:'https://mgq.solutions'},
      {n:'Adidas',l:'https://www.citypng.com/public/uploads/preview/adidas-black-logo-701751694777212bstvn6c2g9.png',href:'https://adidas.de'},
      {n:'Nike',l:'https://i.ebayimg.com/images/g/GooAAOSw9ANipV8u/s-l1200.jpg',href:'https://nike.com'}
    ]
  };

  /* ---------------- Helpers --------------- */
  const q=v=>v==='✓'?'<span class="badge q">✓</span>':v==='✗'?'<span class="badge out">✗</span>':'';
  const p=x=>{const n=+x;return n===1?'<span class="badge gold">1</span>':n===2?'<span class="badge silver">2</span>':n===3?'<span class="badge bronze">3</span>':n?`<span class="badge final">${n}</span>`:'';};

  function row(cols){return `<div class="row">${cols}</div>`;}
  function cell(cls,label,val){return `<span class="col ${cls}" data-label="${label}">${val}</span>`;}

  /* ---------------- Render ---------------- */
  async function load(){
    const j=await (await fetch(CFG.api+'?v='+Date.now())).json();

    /* Leaderboard */
    list('leader', j.leaderboard.slice(1).map(r=>
      row(cell('platz','Platz',r[0])      + cell('start','Startnummer',r[1]) +
        cell('fahrer','Fahrer',r[2])    + cell('punkte','Punkte',r[3]))));

    /* Viertel / Halb */
    const rPhase=r=>row(cell('rennen','Rennen',r[1])+cell('start','Startnummer',r[2])+
      cell('fahrer','Fahrer',r[3])+cell('qual','Qualifiziert',q(r[5])));
    list('vf',  j.viertel.slice(1).map(rPhase));
    list('hf',  j.halb.slice(1).map(rPhase));

    /* Finale (Platz-Badge) */
    list('fin', j.finale.slice(1).map(r=>
      row(cell('platz','Platz',p(r[4])) + cell('start','Startnummer',r[2]) + cell('fahrer','Fahrer',r[3]))));

    /* Timestamp */
    const ts=new Date().toLocaleTimeString('de-DE',{hour12:false});
    ['leader','vf','hf','fin'].forEach(id=>document.getElementById('upd-'+id).textContent='Aktualisiert: '+ts);
  }

  function list(id,htmlArr){document.getElementById('list-'+id).innerHTML=htmlArr.join('');}

  /* ---------------- Sponsors --------------- */
  document.getElementById('sponsorTrack').innerHTML =
    CFG.sponsors.map(s=>`<a href="${s.href}" target="_blank"><img src="${s.l}" alt="${s.n}"></a>`).join('').repeat(2);

  /* ---------------- Tabs ------------------- */
  for(const b of document.querySelectorAll('#tabs button')){
    b.onclick=()=>{document.querySelectorAll('#tabs button').forEach(x=>x.classList.toggle('active',x===b));
      document.querySelectorAll('.section').forEach(s=>s.classList.toggle('active',s.id===b.dataset.tab));};
  }

  /* ---------------- Start ------------------ */
  load(); setInterval(load,CFG.refresh);
</script>
</body>
</html>